{% extends 'base.html' %}

{% block stylesheet %}

    {% include 'style.css' %}
{% endblock %}

{% block content %}
    <div class='container'>
        {% include 'status.html' %}
    </div>
    <br/>
    <br/>
        <div class='pull-right'><a href="{% url 'branch_create' %}" class='btn btn-success btn-lg'><i class="fa fa-plus-circle" aria-hidden="true"></i> Create Alert</a> </div>

    {% include 'branch_navigation.html' %}
    <div class='container-fluid'>
        <div class='table-responsive'>
            <table class='table table-striped table-bordered table-sm'>
                <tr>
                        <th>ID</th>
                        <th>Exception</th>
                        <th>Exception Type</th>
                        <th>Decision</th>
                        <th>Activity</th>
                        <th>Affiliate Code</th>
                        <th>Acccount Number</th>
                        <th>Account Name</th>
                        
                        <th>Root Cause</th>
                        <th>Status</th>
                        <th>Date Regularized</th>
                        <th>CURRENCY</th>
                        <th>Amount Involved(LCY)</th>
                        <th>Initialting Branch</th>
                        <th>UserId Inputter</th>
                        <th>UserId Authoriser</th>
                        <th>TRF_REF_NO</th>
                        <th>MSISDN</th>
                        <th>Account Class</th>
                        <th>Account tier</th>
                        <th>DRCR_IND</th>
                        <th>Available balance</th>
                        <th>Onboarding Date</th>
                        <th>Tnx Count</th>
                        
                    </tr>

                    {% if alerts %}
                    {% for alert in alerts %}
                        <tr id="alert-{{alert.id}}">
                            <td class="font-weight-bold"><a href="{% url 'response' alert.id %}" data-toggle="tooltip" title="Click to update">{{ alert.id }}</a></td>
                            <td>{{ alert.Exception_Category }}</td>
                            <td>{{ alert.Exception_By_Category_Type }}</td>
                            <td>{{ alert.camtDecision }}</td>
                            <td>
                                {% if alert.statusCheck == "Closed" %}
                            <span class='font-weight-bold' style='color:green'>Closed</span>
                            {% else %}
                            <a href="{% url 'response' alert.id %}" class='btn btn-sm btn-danger mt-3'><span style='color:white'>Pending</span></a>
                            {% endif %}
                            </td>
                            <td>{{ alert.Affiliate_Code }}</td>
                            <td>
                            <a href="/search/?q={{ alert.Acccount_Number }}" type='submit' data-toggle="tooltip" title="Check if account number have been investigated">{{ alert.Acccount_Number }}</a>
                            </td>
                            <td><a href="{% url 'response' alert.id %}" data-toggle="tooltip" title="click to update">{{ alert.Account_Name }}</a></td>
                            <td>{{ alert.Root_Cause_Tag }}</td>
                            <td>{{ alert.Status_REGULARIZED_UNREGULARIZED }}</td>
                            <td>{{ alert.Date_Regularised|date:"Y-m-d" }}</td>
                            <td>{{ alert.Currency }}</td>
                            <td>{{ alert.Amount_Involved_LCY }}</td>
                            <td>{{ alert.Initiating_Branch }}</a></td>
                            <td>{{ alert.USERID_Inputter }}</td>
                            <td>{{ alert.USERID_Authoriser }}</td>
                            <td>{{ alert.Trn_Ref_no }}</td>
                            <td><a data-toggle="tooltip" title="Check if phone number have been investigated">{{ alert.msisdn }}</a></td>
                            <td>{{ alert.ACCOUNT_CLASS }}</td>
                            <td>{{ alert.account_tier }}</td>
                            <td>{{ alert.DRCR_IND }}</td>
                            <td>{{ alert.ACY_CURR_BALANCE }}</td>
                            <td>{{ alert.ONBOARDING_DATE }}</td>
                            <td>{{ alert.Count2 }}</td>
                        </tr>
                    {% endfor %}
                    {% endif %}
            </table>
        </div>
    </div>
{% endblock %}